"use strict";(self["webpackChunkpreject_"]=self["webpackChunkpreject_"]||[]).push([[7584],{7584:function(t,s,a){a.r(s),a.d(s,{default:function(){return d}});var e=function(){var t=this,s=t._self._c;return s("div",{staticClass:"cart"},[s("h4",[t._v("全部商品")]),s("div",{staticClass:"cart-main"},[t._m(0),s("div",{staticClass:"cart-body"},t._l(t.cartInfoList,(function(a){return s("ul",{key:a.id,staticClass:"cart-list"},[s("li",{staticClass:"cart-list-con1"},[s("input",{attrs:{type:"checkbox",name:"chk_list"},domProps:{checked:1===a.isChecked},on:{input:function(s){return t.isCheckedChange(a)}}})]),s("li",{staticClass:"cart-list-con2"},[s("img",{attrs:{src:a.imgUrl}}),s("div",{staticClass:"item-msg"},[t._v(" "+t._s(a.skuName)+" ")])]),t._m(1,!0),s("li",{staticClass:"cart-list-con4"},[s("span",{staticClass:"price"},[t._v(t._s(a.skuPrice))])]),s("li",{staticClass:"cart-list-con5"},[s("a",{staticClass:"mins",on:{click:function(s){return t.goodsNumChange(a,-1)}}},[t._v(" - ")]),s("input",{staticClass:"itxt",attrs:{autocomplete:"off",type:"text",minnum:"1"},domProps:{value:a.skuNum},on:{input:function(s){return t.changeSkuNumDebu(s,a)}}}),s("a",{staticClass:"plus",on:{click:function(s){return t.goodsNumChange(a,1)}}},[t._v("+")])]),s("li",{staticClass:"cart-list-con6"},[s("span",{staticClass:"sum"},[t._v(t._s(a.skuPrice*a.skuNum))])]),s("li",{staticClass:"cart-list-con7"},[s("a",{staticClass:"sindelet",on:{click:function(s){return t.cartGoodsDelete(a.skuId)}}},[t._v("删除")]),s("br"),s("a",{attrs:{href:"#none"}},[t._v("移到收藏")])])])})),0)]),s("div",{staticClass:"cart-tool"},[s("div",{staticClass:"select-all"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.allChange,expression:"allChange"}],staticClass:"chooseAll",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.allChange)?t._i(t.allChange,null)>-1:t.allChange},on:{change:function(s){var a=t.allChange,e=s.target,c=!!e.checked;if(Array.isArray(a)){var i=null,l=t._i(a,i);e.checked?l<0&&(t.allChange=a.concat([i])):l>-1&&(t.allChange=a.slice(0,l).concat(a.slice(l+1)))}else t.allChange=c}}}),s("span",[t._v("全选")])]),s("div",{staticClass:"option"},[s("a",{on:{click:t.CartdeleteCheckGoods}},[t._v("删除选中的商品")]),s("a",{attrs:{href:"#none"}},[t._v("移到我的关注")]),s("a",{attrs:{href:"#none"}},[t._v("清除下柜商品")])]),s("div",{staticClass:"money-box"},[s("div",{staticClass:"chosed"},[t._v(" 已选择 "),s("span",[t._v(t._s(t.allCheck))]),t._v("件商品 ")]),s("div",{staticClass:"sumprice"},[s("em",[t._v("总价（不含运费） ：")]),s("i",{staticClass:"summoney"},[t._v(t._s(t.allPrise))])]),s("div",{staticClass:"sumbtn"},[s("router-link",{staticClass:"sum-btn",attrs:{to:"/trade"}},[t._v("结算")])],1)])])])},c=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"cart-th"},[s("div",{staticClass:"cart-th1"},[t._v("全部")]),s("div",{staticClass:"cart-th2"},[t._v("商品")]),s("div",{staticClass:"cart-th3"},[t._v("单价（元）")]),s("div",{staticClass:"cart-th4"},[t._v("数量")]),s("div",{staticClass:"cart-th5"},[t._v("小计（元）")]),s("div",{staticClass:"cart-th6"},[t._v("操作")])])},function(){var t=this,s=t._self._c;return s("li",{staticClass:"cart-list-con3"},[s("div",{staticClass:"item-txt"},[t._v("语音升级款")])])}],i=(a(7658),a(7877)),l=a(4806),n={name:"ShopCart",data(){return{cartInfoList:[]}},mounted(){this.goodListGet(),this.changeSkuNumDebu=(0,l.debounce)(this.changeSkuNum,400)},computed:{allChange:{get(){return this.cartInfoList&&this.cartInfoList.every((t=>1===t.isChecked))},async set(t){try{let s=this.cartInfoList.map((t=>t.skuId));await(0,i.goodsChangeAll)(t?1:0,s),this.goodListGet()}catch(s){alert(s.message)}}},allCheck(){return this.cartInfoList?.reduce(((t,s)=>1===s.isChecked?t+1*s.skuNum:t),0)},allPrise(){return this.cartInfoList?.reduce(((t,s)=>1===s.isChecked?t+s.skuPrice*s.skuNum:t),0)}},methods:{async goodListGet(){try{let t=await(0,i.getGoodList)(),s=t[0]?.cartInfoList.map((t=>(t.flag=!1,t.oldSkuNum=t.skuNum,t)));this.cartInfoList=s}catch(t){alert(t)}},async isCheckedChange(t){let{isChecked:s,skuId:a}=t;try{await(0,i.changeIsChecked)(a,1===s?0:1),this.goodListGet()}catch(e){console.log(e)}},async cartGoodsDelete(t){try{await(0,i.deleteCartGoods)(t),this.goodListGet(),alert("删除成功")}catch(s){console.log(s.message)}},async goodsNumChange(t,s){if(!t.flag){if(t.flag=!0,t.skuNum+s<=0)return t.flag=!1;try{await(0,i.addGoodscat)(t.skuId,s),await this.goodListGet(),t.flag=!1}catch(a){console.log(a.message),t.flag=!1}}},async changeSkuNum(t,s){const a=/^[1-9]+$/;if(a.test(t.target.value)){let a=t.target.value-s.oldSkuNum;await(0,i.addGoodscat)(s.skuId,a),s.skuNum=t.target.value,s.oldSkuNum=s.skuNum}else t.target.value=s.oldSkuNum,s.skuNum=s.oldSkuNum},changeSkuNumDebu(){},async CartdeleteCheckGoods(){let t=this.cartInfoList?.reduce(((t,s)=>(1===s.isChecked&&t.push(s.skuId),t)),[]);console.log(t);try{await(0,i.deleteCartCheckGoods)(t)}catch(s){console.log(s.message)}}}},o=n,r=a(1001),u=(0,r.Z)(o,e,c,!1,null,"59ee33cc",null),d=u.exports}}]);
//# sourceMappingURL=7584.049c2457.js.map